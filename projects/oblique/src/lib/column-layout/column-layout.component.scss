@import "../../styles/scss/core/variables";
@import "../../styles/scss/core/mixins/layout";
@import "../../styles/scss/core/mixins/column-layout";
@import "../../styles/scss/core/mixins/shadow";

.ob-column-layout {
	display: flex;
	flex-direction: column;
	overflow: hidden;	// cannot set overflow-x as it will add a vertical scrollbar

	.ob-column-toggle-left,
	.ob-column-toggle-right {
		display: none;
	}

	.ob-column-left,
	.ob-column-right {
		order: 1;
	}

	@include ob-media-breakpoint-up(sm) {
		flex-direction: row;
		flex-wrap: wrap;

		.ob-column-main,
		.ob-column-left,
		.ob-column-right {
			flex-grow: 1;
		}

		.ob-master-layout.ob-has-layout &:not(.ob-no-layout) {
			> .ob-column-left,
			> .ob-column-main:not(:last-child) {
				> .ob-column-content {
					padding-right: $ob-spacing-default;
				}
			}

			> .ob-column-right,
			> .ob-column-main:not(:first-child) {
				> .ob-column-content {
					padding-left: $ob-spacing-default;
				}
			}
		}

		.ob-master-layout:not(.ob-has-layout) &:not(.ob-no-layout) {
			> .ob-column-left,
			> .ob-column-right,
			> .ob-column-main {
				> .ob-column-content {
					padding-right: $ob-spacing-default;
					padding-left: $ob-spacing-default;
				}
			}
		}

		.ob-column-main {
			flex: 1 1 100%;
		}

		.ob-column-content {
			height: 100%;
		}
	}

	@include ob-media-breakpoint-up(md) {
		min-height: $ob-column-layout-toggle-height;
		flex-wrap: nowrap;

		.ob-column-toggle-left,
		.ob-column-toggle-right {
			display: block;
			position: absolute;
			z-index: $ob-z-index-controls;
			top: 50%;
			margin-top: -$ob-column-layout-toggle-height * 0.5;
			width: $ob-column-layout-toggle-width;
			height: $ob-column-layout-toggle-height;
			font-size: 17px;
			text-align: center;
			padding: 0;
			border: 1px solid $ob-gray-light;
			background-color: $ob-white;

			transition: all $ob-duration-default;
			color: $ob-gray-dark;

			@at-root #{selector-append(".ob-font-awesome", &)} {
				color: $ob-gray-light;
			}

			&:hover,
			&:focus {
				transform: scale(1.25);
				color: $ob-default;
				border-color: $ob-gray;
				cursor: pointer;
			}
		}

		.ob-column-toggle-left {
			transform-origin: 100% 50%;
			right: 0;
			margin-left: -$ob-column-layout-toggle-width;
			border-radius: $ob-column-layout-toggle-radius 0 0 $ob-column-layout-toggle-radius;
			border-right-width: 0;
			@include ob-dropShadow(down-left);

			@at-root #{selector-append(":not(.ob-font-awesome)", &)} {
				.ob-icon-wrapper {
					margin-left: -4px;
				}
			}
		}

		.ob-column-toggle-right {
			transform-origin: 0 50%;
			left: 0;
			margin-right: -$ob-column-layout-toggle-width;
			border-radius: 0 $ob-column-layout-toggle-radius $ob-column-layout-toggle-radius 0;
			border-left-width: 0;
			@include ob-dropShadow();

			@at-root #{selector-append(":not(.ob-font-awesome)", &)} {
				.ob-icon-wrapper {
					margin-left: -5px;
				}
			}
		}

		.ob-column-main {
			position: relative;
		}

		.ob-column-left,
		.ob-column-right {
			position: relative;
			flex: 0 0 $ob-column-width;
			order: 0;
			max-width: $ob-column-width; // Ensure columns keep shrinking even if text content may overflow.

			@at-root #{selector-append(".ob-wider-columns", &)} {
				flex-basis: 2 * $ob-column-width;
				max-width: 2 * $ob-column-width;
			}
		}

		.ob-column-left {
			transition: margin-left $ob-duration-default;

			&.ob-collapsed {
				margin-left: -$ob-column-width;

				@at-root #{selector-append(".ob-wider-columns", &)} {
					margin-left: - 2 * $ob-column-width;
				}

				.ob-column-toggle-left {
					transform-origin: 0 50%;
					margin-left: 0;
					margin-right: -$ob-column-layout-toggle-width;
					border-radius: 0 $ob-column-layout-toggle-radius $ob-column-layout-toggle-radius 0;
					border-right-width: 1px;
					border-left-width: 0;
					@include ob-dropShadow();
				}
			}

			&:after {
				@include ob-column-separator {
					right: 0;
				}
			}
		}

		.ob-column-right {
			transition: margin-right $ob-duration-default;

			&.ob-collapsed {
				margin-right: -$ob-column-width;

				@at-root #{selector-append(".ob-wider-columns", &)} {
					margin-right: - 2 *$ob-column-width;
				}

				.ob-column-toggle-right {
					transform-origin: 100% 50%;
					margin-right: 0;
					margin-left: -$ob-column-layout-toggle-width;
					border-radius: $ob-column-layout-toggle-radius 0 0 $ob-column-layout-toggle-radius;
					border-right-width: 0;
					border-left-width: 1px;
					@include ob-dropShadow(down-left);
				}
			}

			&:before {
				@include ob-column-separator {
					left: 0;
				}
			}
		}
	}

	.ob-master-layout-fixed & {
		height: 100%;

		.ob-column-main,
		.ob-column-content {
			overflow-y: auto;
			overflow-x: hidden;
		}
	}
}
